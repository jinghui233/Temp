using System.Collections.Generic;
using UnityEngine;

namespace ECFramework
{
    public class EntityPool
    {
        private readonly Queue<Entity> instanceQueue = new();
        public Transform transform;
        private string defName;
        public EntityPool(string defName, Transform transform)
        {
            this.defName = defName;
            this.transform = transform;
        }
        public Entity GetInstance()
        {
            Entity instance;
            if (instanceQueue.Count > 0)
            {
                instance = instanceQueue.Dequeue();
            }
            else
            {
                instance = XmlHelper.GetEntity(defName);
                instance.InitUnityComponent();
            }
            return instance;
        }
        public void ReturnInstance(Entity instance)
        {
            instanceQueue.Enqueue(instance);
            if (instance.GameObject != null)
            {
                instance.GameObject.transform.SetParent(transform);
            }
            instance.OnUnSpawn();
        }
    }
}
